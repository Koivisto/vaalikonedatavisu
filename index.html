<!DOCTYPE html>
<head>
<title>NULL</title>
<!--<link rel="shortcut icon" href="" />
<meta name="author" content="" />-->
<meta charset="utf-8"/>
<style type="text/css">
@-ms-viewport{
	width: device-width;
}
body{
	margin: 0px 0px 0px 0px; /*top right bottom left*/
	max-width: 1800px ;
	margin-left: auto;
	margin-right: auto;
	position: relative;
}
article{
	background: #FF9D76;
}

#screenSizeWarning{ 
	display: none;
}

/*svg elements styles, ATTENTION! the syntax is different from pure html elements (color=fill etc.)*/
svg{
	background-color: #7D9886;
}
text{
	fill: #FFFFFF;
}
circle {
	stroke: #006600;
	fill  : #00cc00;
}

@media only screen and (max-width: 999px){
	#screenSizeWarning{ 
		display: block;
		float: right;
		background-color: #F00;
	}
}

</style>
<!--jQuery initializing-->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<!--D3.js library initializing-->
<script src="http://d3js.org/d3.v3.min.js"></script>
<!--Other javascript for the page-->
<script type="text/javascript">
</script>
</head>

<body>
	<article>

<header>
	<h1>Otsikko jos ois</h1>
	<p>Tähän tulee jotain metajuttuja, tekijöitä ja sellasia</p>
</header>

<p id="screenSizeWarning" >Visualisointi tarvitsee lisää näyttötilaa!</p>

<div id="explanation" style="visibility: hidden; position: absolute; color:#000;">lolselite</div>

<div id="visualizationDiv">
	<svg id="visualizationSvg"></svg>
</div>
<!--Visualization logic-->
<script type="text/javascript" charset="utf-8">

var width = $(document).width();
var height = getHeight();

function getHeight(){
	if( $(window).height() > 1000 ){return 1000;}
	else{return $(window).height();}
};

var svg = d3.select("#visualizationSvg");
svg
.attr("width", width)
.attr("height", height)

//Responsiivinen alkaa
function redraw() {
	//Vanhan poistaminen
	svg.selectAll("circle").remove();
	svg.selectAll("text").remove();

width = $("#visualizationDiv").width();
var height = getHeight();
svg
.attr("width", width)
.attr("height", height)

//Data alkaa
d3.csv("testidata.csv", function(d){

var person = svg.append("g")

svg.selectAll("circle")
	.data(d)
	.enter()
		.append("circle")
		.attr("cx", function(d){return width/2+((+d.scorex)*(width/6));})
		.attr("cy", function(d){return height/2+((+d.scorey)*(height/6));})
		.attr("r", 8)
		.on('mouseover', function(d){
			//d3.select(this).style({opacity:'0.2'});
			//displayInfo(d3.select(this));
			displayInfo(d3.select(this), d.name, d.party, +d.scorex, +d.scorey);
			})	
		.on('mouseleave', function(d){
			dontDisplayInfo();
			d3.select(this).style({opacity:'1.0'});
			})		
		.style("fill", function(d){
			if     (d.party == "KOK") return "blue";
			else if(d.party == "RKP") return "yellow";
			else if(d.party == "PS") return "grey";
			else if(d.party == "KESK") return "green";
			else if(d.party == "VIHR") return "GnBu";
			else if(d.party == "VAS") return "#FF0700";
			else if(d.party == "SKP") return "#55110F";
			else if(d.party == "KD") return "#9333C0";
			else if(d.party == "IP") return "#5596CC";
			else if(d.party == "PIR") return "black";
			else if(d.party == "M11") return "white";
			else if(d.party == "SDP") return "#930C08";
			else return "red";
		});

function displayInfo(personCircle, name, party, scorex, scorey){
personCircle.style({opacity:'0.2'});

svg.selectAll("text")
	.data(d)
	.enter()
	.append("svg:text")
		.attr("x", width/2)//personCircle.cx)//function(personCircle){return personCircle.cx})
		.attr("y", height/2)//personCircle.cy)//function(personCircle){return personCircle.cy})
		.text(function(d){
			var explString = name+" "+party+" "+scorex+" "+scorey;

			d3.select("#explanation")
				.style("visibility", "")
				.style("display", "block");

			//aina kun dokumentissa on hiiri, kutsutaan funktiota
			document.onmousemove = annaKoordinaatit;
			var Xakseli = 0
			var Yakseli = 0
			//funktio
			function annaKoordinaatit(e) {
				//tallentaa tällä tietoja muuttujiin
				Xakseli = e.pageX
				Yakseli = e.pageY
				//näyttää tekstinä sisällä
				document.getElementById('explanation').innerHTML = explString;
				//positioi divin hiiren mukaiseen paikkaan
			    document.getElementById('explanation').style.top = +Yakseli+ 10+'px';
				document.getElementById('explanation').style.left = +Xakseli+ 10+'px';
			}

			//d3.select("#explanation")
			//	.style("display", "block")
			//	.style("left", "1000px")
			//	.style("top", "2000px")
			//	.text(explString)
			//	;
			return explString;
		});
	//alert("MOI");
}

function dontDisplayInfo(){
	svg.selectAll("text").remove();
	d3.select("#explanation")
		.style("visibility", "none")
		.style("display", "none");
}

/*
svg.selectAll("text")
	.data(d)
	.enter()
		.append("text")
		.attr("x", function(d){return width/2+((+d.scorex)*(width/6));})
		.attr("y", function(d){return height/2+((+d.scorey)*(height/6));})
		//.text(function(d){return d.name+" "+d.party+" x-ero: "+d.scorex+" y-ero: "+d.scorey;});
*/
});//Data loppuu

}//Responsiivinen loppuu
d3.select(window).on('resize', redraw); 
redraw();


</script>

<p>Visualisointi tossa päällä. Tähän tulee tiukkaa analyysiä</p>

	</article>
</body>
</html>